---
  - name: Installing Multiple packages
    hosts: all
    become: true

    vars: 
      package_name: 
        Ubuntu: apache2
        Amazon: httpd

    tasks: 
      - name: Install packages on Ubuntu
        apt:
          name: "{{ item }}"
          state: present
        with_item: 
          - nginx
          - apache2
          - git
          - nodejs
        when: ansible_distribution == "Ubuntu"

      - name: Install apache webserver Ubuntu
        apt:
          name: "{{ package_name['Ubuntu'} }}"
          state: present
        when: ansible_distribution == "Ubuntu"
      
      - name: install nginx on Al2
        yum:
          name: nginx
          state: present
        when: ansible_distribution == "Amazon"

      - name: Install Nginx on Ubuntu
        apt:
          name: nginx
          state: present
        when: ansible_distribution == "Ubuntu"

      - name: Install Cronjob
        yum: 
          name: cronie
          state: present 
      
      - name: Start Nginx
        service: 
          name: nginx
          state: started 
          enabled: true

# ansible-playbook -i inventory.ini nginx_install.yml
